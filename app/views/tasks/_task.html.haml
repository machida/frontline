= content_tag_for :li, task, :class => "task" do
  %p
    = nl2br task.content
    .helpme
      = "HELP ME!!!" if task.help
    - if task.state == "done"
      .times
        %ul
          %li.working
            working
            = distance_of_time_in_words(task.started_at, task.finished_at)
          %li.finish
            finish
            = task.finished_at.to_s(:time)
  - case task.state
  - when "current"
    - if user_signed_in? && current_user == task.user
      .actions
        %ul
          %li.hold= link_to "hold", hold_party_task_path(@party, task), :remote => true
          %li.finish= link_to "finish", finish_party_task_path(@party, task), :remote => true
        %p.help
          = link_to help_message(task), help_party_task_path(@party, task), :remote => true
  - when "backlog"
    - if user_signed_in? && current_user == task.user
      %p.start= link_to "start", start_party_task_path(@party, task), :remote => true
      %p= link_to "delete", party_task_path(@party, task), :method => :delete, :remote => true
  - when "done"
    - if user_signed_in? && current_user == task.user
      %p= link_to "redo", redo_party_task_path(@party, task), :remote => true
